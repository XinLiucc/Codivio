# 测试账号记录

> 记录开发和测试过程中创建的测试账号，方便后续开发使用

---

## 🔐 用户服务测试账号

### 已注册用户账号

#### 1. testuser (主要测试账号)
- **用户名**: `testuser`
- **密码**: `password123`  
- **邮箱**: `updated@example.com`
- **昵称**: `Gateway Test User` (2025-08-29更新)
- **头像**: `https://example.com/avatar.jpg`
- **状态**: 正常 (status: 1)
- **创建时间**: 2025-08-19
- **用途**: 主要用于登录、JWT认证、用户信息更新测试、**网关统一认证测试**

#### 2. newuser (重复邮箱测试)
- **用户名**: `newuser`
- **密码**: `password123`
- **邮箱**: `test@example.com`
- **昵称**: `New User`
- **状态**: 正常 (status: 1)
- **创建时间**: 2025-08-26 (异常处理测试时创建)
- **用途**: 用于测试邮箱重复注册异常处理

---

## 🧪 测试场景对应

### 异常处理测试 (2025-08-26)
- **用户名重复**: 尝试注册`testuser` → 20211错误码
- **邮箱重复**: 尝试注册`test@example.com` → 20212错误码  
- **用户不存在**: 登录`nonexistentuser` → 20221错误码
- **密码错误**: 登录`testuser`+错误密码 → 20222错误码
- **参数验证**: 密码不匹配/长度不足 → 20001错误码

### JWT认证测试
- **有效token**: 使用`testuser`登录获取的JWT
- **无效token**: `invalid.jwt.token` (被Spring Security拦截)

---

## 📝 使用建议

### 开发测试
- 使用`testuser`进行日常功能测试
- 使用`newuser`进行邮箱相关的边界测试

### API测试

#### 通过网关测试 (推荐，2025-08-29新增)
```bash
# 通过网关登录获取token
curl -X POST http://localhost:8080/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"loginId": "testuser", "password": "password123"}'

# 通过网关测试用户信息接口 (统一认证)
curl -X GET http://localhost:8080/api/v1/users/profile \
  -H "Authorization: Bearer {获取到的JWT_TOKEN}"

# 通过网关更新用户信息
curl -X PUT http://localhost:8080/api/v1/users/profile \
  -H "Authorization: Bearer {JWT_TOKEN}" \
  -H "Content-Type: application/json" \
  -d '{"nickname": "New Nickname"}'
```

#### 直接服务测试 (兼容模式)
```bash
# 直接访问用户服务登录
curl -X POST http://localhost:8081/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"loginId": "testuser", "password": "password123"}'

# 直接测试用户信息接口
curl -X GET http://localhost:8081/api/v1/users/profile \
  -H "Authorization: Bearer {获取到的JWT_TOKEN}"
```

### 注意事项
- 密码统一使用`password123`便于记忆
- `testuser`的昵称已更新为`Gateway Test User` (2025-08-29网关测试)
- **推荐使用网关端口8080进行测试，体验统一认证功能**
- 这些账号仅用于开发测试，生产环境需要删除

---

## 🔗 网关统一认证测试记录 (2025-08-29)

### 测试验证场景
- ✅ **网关JWT认证**: 通过8080端口的统一认证
- ✅ **用户验证机制**: 网关调用用户服务验证用户真实性
- ✅ **请求头传递**: `X-User-Id`, `X-Username`正确传递
- ✅ **用户信息获取**: GatewayUserUtil正确提取用户信息
- ✅ **用户信息更新**: 通过网关成功更新用户昵称

### 测试使用的账号
- **testuser**: 主要测试账号，用于验证完整的认证流程
- **gatewaytest**: 网关专用测试账号 (ID: 4)

---

*创建时间: 2025-08-26*  
*最后更新: 2025-08-29 (添加网关统一认证测试记录)*