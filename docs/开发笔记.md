# Codivio 开发笔记

> 记录项目开发过程中的技术笔记、工作内容和问题解答

## 2025-08-14 - 项目启动与基础架构搭建

### ✅ 完成的工作

#### 1. 项目基础架构搭建
- **Docker环境配置**
  - 创建 `docker-compose.yml` 统一编排服务
  - 配置 MySQL 8.0 数据库服务
  - 配置 Redis 7 缓存服务  
  - 配置 RabbitMQ 3 消息队列服务
  - 设置 Nginx 反向代理和负载均衡

- **数据库设计**
  - 创建用户服务数据库 `codivio_user`
  - 创建项目服务数据库 `codivio_project`
  - 设计用户表、项目表、文件表等基础表结构
  - 配置数据库初始化脚本

- **开发环境配置**
  - 添加 `.env` 环境变量配置
  - 更新 `.gitignore` 忽略不必要文件
  - 创建 `README-SETUP.md` 开发指南

#### 2. 用户服务基础框架
- **技术栈选择**
  - Spring Boot 3.2.0 + Java 17
  - Maven 项目管理
  - Logback 日志系统
  - Spring Actuator 监控

- **服务搭建**
  - 创建 Spring Boot 主启动类
  - 配置 `application.yml` 基础配置
  - 添加健康检查接口 `/api/user/health`
  - 配置 Spring Actuator 端点
  - 创建 Dockerfile 支持容器化

- **验证测试**
  - ✅ Maven 编译成功
  - ✅ 应用启动成功（8081端口）
  - ✅ 健康检查接口正常响应
  - ✅ Spring Actuator 监控正常

### 🤔 技术问题与解答

#### Q: Nginx在架构中的作用是什么？
**A: Nginx 作为反向代理和统一入口**
- **统一入口**: 所有外部请求通过 Nginx(80端口) 进入系统
- **路由分发**: 
  - `/api/*` → Gateway服务 (8080端口)
  - `/ws/*` → 协作服务WebSocket (8083端口)  
  - `/` → 前端静态资源 (3000端口)
- **负载均衡**: 支持服务多实例部署
- **静态资源服务**: 直接服务前端文件

#### Q: 服务间通信方式？
**A: 分层通信架构**
```
Frontend → Nginx(80) → Gateway(8080) → Services(808x)
                                     ↓
                               MySQL + Redis + RabbitMQ
```

- **当前阶段**: Frontend → Nginx → User-Service(8081)
- **完整架构**: Frontend → Nginx → Gateway → 各微服务

#### Q: 如何测试 User-Service？
**A: 三种测试方式**
1. **直接测试**: `curl http://localhost:8081/api/user/health`
2. **Docker测试**: `docker-compose up -d user-service`
3. **完整链路**: `curl http://localhost/api/user/health` (需要网关)

### 🎯 代码提交记录
- `feat: 搭建项目基础架构和Docker环境`
- `feat: 创建用户服务基础框架`

### 📝 开发心得
- 采用**渐进式开发**策略，先搭建基础框架再逐步完善功能
- **Docker化优先**，保证开发环境一致性  
- **健康检查**是微服务的基础，便于监控和调试
- **分离关注点**，基础设施和业务服务分别提交

### 🔄 下一步计划
- 完善用户服务：添加注册、登录API和JWT认证
- 或者继续搭建Gateway服务：统一路由和认证